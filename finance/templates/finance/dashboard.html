{% extends 'base.html' %}
{% block content %}
<h1>Dashboard</h1>

<form method="get">
  <label for="month">Select Month:</label>
  <input type="month" name="month" id="month" value="{{ selected_month|date:'Y-m' }}">
  <button type="submit">Go</button>
</form>

<h3>Transactions for: {{ selected_month|date:"F Y" }}</h3>
{% if selected_month|date:'Y-m' != current_month|date:'Y-m' %}
  <a href="{% url 'finance:dashboard' %}" class="button">Back to Current Month</a>
{% endif %}
<ul>
  <li>Total Income: {{ income|floatformat:2 }}</li>
  <li>Total Expenses: {{ expense|floatformat:2 }}</li>
  <li>Net: {{ net|floatformat:2 }}</li>
</ul>

<h3>Recent Transactions</h3>
<table>
  <tr><th>Date</th><th>Type</th><th>Category</th><th>Amount</th><th>#</th></tr>
  {% for t in recent_transactions %}
    <tr>
      <td>{{ t.date }}</td>
      <td>{{ t.get_entry_type_display }}</td>
      <td>{{ t.category.name|default:"Uncategorized" }}</td>
      {% if t.get_entry_type_display == "Income" %}
        <td>{{ t.amount }}</td>
      {% else %}
        <td>- {{ t.amount }}</td>
      {% endif %}
      <td>
        <a href="{% url 'finance:edit_transaction' t.pk %}">edit</a> |
        <a href="{% url 'finance:delete_transaction' t.pk %}">Delete</a>
      </td>
    </tr>
  {% empty %}
    <tr><td colspan="4">No transactions yet.</td></tr>
  {% endfor %}
</table>

<a href="{% url 'finance:add_transaction' %}">+ Add Transaction</a>
<p><a href="{% url 'finance:category_list' %}">Manage Categories</a></p>
<p><a href="{% url 'finance:account_list' %}">Manage Accounts</a></p>
{% endblock %}
